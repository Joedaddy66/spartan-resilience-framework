# Artifact Templates

This directory contains attestation artifacts generated by drift-sentinel validators.

## File Formats

### JSON Format (`.json`)
Machine-readable attestation with structured control status, findings, and metadata.

**Example: `aws-guardrails-attestation.json`**
```json
{
  "version": "0.9.1",
  "timestamp": "2025-10-31T04:30:58Z",
  "account_id": "123456789012",
  "region": "us-east-1",
  "controls": [
    {
      "id": "A1",
      "name": "No Long-Term Credentials",
      "status": "compliant",
      "checks": {
        "oidc_role": "checked"
      }
    }
  ],
  "summary": {
    "passed": 4,
    "warnings": 0,
    "errors": 0
  }
}
```

### SARIF Format (`.sarif`)
Security Analysis Results Interchange Format for GitHub Code Scanning integration.

**Example: `aws-guardrails-attestation.sarif`**
```json
{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "AWS Drift Sentinel",
          "version": "0.9.1",
          "informationUri": "https://github.com/Joedaddy66/spartan-resilience-framework"
        }
      },
      "results": [
        {
          "ruleId": "A2",
          "level": "error",
          "message": {
            "text": "S3 bucket 'example-bucket' does not have Public Access Block configured"
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "s3://example-bucket"
                }
              }
            }
          ]
        }
      ]
    }
  ]
}
```

### Markdown Format (`.md`)
Human-readable reports for documentation and review.

**Example: `aws-guardrails-attestation.md`**
```markdown
# AWS Guardrails Attestation Report

**Version:** 0.9.1  
**Timestamp:** 2025-10-31T04:30:58Z  
**Account:** 123456789012  
**Region:** us-east-1

## Summary

- ✅ Passed: 4
- ⚠️  Warnings: 0
- ❌ Errors: 0

## Control Results

### A1: No Long-Term Credentials
Status: ✅ Compliant

### A2: Storage Public Access Blocked
Status: ✅ Compliant
- Non-compliant buckets: 0
```

### CSV Format (`.csv`)
Spreadsheet-compatible format for analysis and reporting.

**Example: `aws-guardrails-attestation.csv`**
```csv
Control ID,Control Name,Status,Details
A1,No Long-Term Credentials,compliant,OIDC role checked
A2,Storage Public Access Blocked,compliant,0 buckets non-compliant
A6,CloudTrail Multi-Region Logging,compliant,Multi-region trail status
A7,KMS Key Rotation,compliant,0 keys non-compliant
```

## File Naming Conventions

- **AWS**: `aws-guardrails-attestation.{json|sarif|md|csv}`
- **Azure**: `azure-policy-attestation.{json|sarif|md}` + `azure-noncompliant.csv`
- **GCP**: `gcp-org-policy-attestation.{json|sarif}` + `policy-attestation.md`

## Retention

Artifacts are retained for 90 days in GitHub Actions workflow runs and can be downloaded from the Actions tab.

## Integration

### GitHub Code Scanning
SARIF files are automatically uploaded to GitHub Security tab via the `github/codeql-action/upload-sarif` action.

### CI/CD Gates
Sentinel validators exit with:
- **Exit code 0**: All controls compliant (PASS)
- **Exit code 42**: Drift detected (FAIL)

Use these exit codes in your CI/CD pipelines to enforce compliance gates.
